#!/usr/bin/env sh

set -e

echo "ğŸ” Running pre-commit checks..."

# Check for staged Java files
STAGED_JAVA_FILES=$(git diff --cached --name-only --diff-filter=ACM | grep '\.java$' ||
true)

if [ -n "$STAGED_JAVA_FILES" ]; then
    echo "ğŸ“ Checking code format..."
    ./gradlew spotlessCheck --quiet

    if [ $? -ne 0 ]; then
        echo ""
        echo "âŒ Code formatting issues found!"
        echo "Run './gradlew spotlessApply' to fix them."
        exit 1
    fi
    echo "âœ… Code format OK"
fi

echo "âœ… Pre-commit checks passed!"