# =============================================================================
# Production Profile
# =============================================================================
# Usage: Set SPRING_PROFILES_ACTIVE=prod
#
# Features:
# - Connects to external PostgreSQL (via environment variables)
# - Swagger UI DISABLED for security
# - Minimal logging (WARN level)
# - Optimized connection pool settings
# - All secrets from environment variables (required)
#
# Required Environment Variables:
# - DATABASE_URL (e.g., jdbc:postgresql://prod-db.example.com:5432/users)
# - DATABASE_USERNAME
# - DATABASE_PASSWORD
# - JWT_ACCESS_SECRET (min 64 bytes for HS512)
# - JWT_REFRESH_SECRET (min 64 bytes for HS512)
# - CORS_ALLOWED_ORIGINS (e.g., https://myapp.com)
#
# Optional Environment Variables:
# - JWT_ACCESS_EXPIRES_IN (default: 15m)
# - JWT_REFRESH_EXPIRES_IN (default: 7d)
# - JWT_ISSUER (default: user-service)
# =============================================================================

spring:
  # External database connection with production-optimized pool
  datasource:
    url: ${DATABASE_URL}
    username: ${DATABASE_USERNAME}
    password: ${DATABASE_PASSWORD}
    driver-class-name: org.postgresql.Driver
    hikari:
      maximum-pool-size: 20
      minimum-idle: 5
      idle-timeout: 300000
      max-lifetime: 1800000
      connection-timeout: 30000
      pool-name: UserServiceHikariPool
      # Production optimizations
      leak-detection-threshold: 60000
      validation-timeout: 5000

  # Disable gRPC reflection in production for security
  grpc:
    server:
      reflection:
        enabled: false

# Swagger UI DISABLED in production
springdoc:
  api-docs:
    enabled: false
  swagger-ui:
    enabled: false

# Production logging - minimal, structured
logging:
  level:
    root: WARN
    org.nkcoder: INFO
    org.springframework.security: WARN
    org.springframework.web: WARN
    org.hibernate.SQL: WARN
    com.zaxxer.hikari: WARN
  # Consider using JSON format for log aggregation in production
  # pattern:
  #   console: '{"timestamp":"%d{ISO8601}","level":"%level","logger":"%logger","message":"%msg"}%n'
